{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///Users/koyaemer/Development/StNinoFinals/lib/supabaseClient.ts"],"sourcesContent":["// lib/supabaseClient.ts\nimport { Database } from '@/database.types'\nimport { createClient } from '@supabase/supabase-js'\n\n/**\n * Supabase Client for Client-Side Operations\n * \n * This client uses the ANON key and is safe to use in browser code.\n * It respects Row Level Security (RLS) policies in Supabase.\n * \n * DO NOT use service role key here - it bypasses RLS and is a security risk.\n * For admin operations, use getSupabaseAdmin() in server-side code only.\n */\n\n// Get environment variables\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n\n// Validate that environment variables are set\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error('Missing Supabase environment variables')\n}\n\n/**\n * Supabase client instance with typed database schema\n * Use this for all client-side database operations\n */\nexport const supabase = createClient<Database>(supabaseUrl, supabaseAnonKey)"],"names":[],"mappings":"AAAA,wBAAwB;;;;;AAExB;;AAEA;;;;;;;;CAQC,GAED,4BAA4B;AAC5B,MAAM;AACN,MAAM;AAEN,8CAA8C;AAC9C;;AAQO,MAAM,WAAW,IAAA,yMAAY,EAAW,aAAa"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///Users/koyaemer/Development/StNinoFinals/app/api/parent/announcements/route.ts"],"sourcesContent":["import { supabase } from '@/lib/supabaseClient'\nimport { NextResponse } from 'next/server'\n\nexport async function GET(request: Request) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const studentId = searchParams.get('student_id')\n\n    if (!studentId) {\n      return NextResponse.json(\n        { success: false, error: 'Student ID is required' },\n        { status: 400 }\n      )\n    }\n\n    // Fetch student info to get their grade level\n    const { data: student, error: studentError } = await supabase\n      .from('users')\n      .select('grade_level, section')\n      .eq('id', studentId)\n      .single()\n\n    if (studentError) {\n      console.error('Error fetching student info:', studentError)\n    }\n\n    // Fetch active announcements\n    // Filter by target audience (all, students, or specific grade level)\n    let query = supabase\n      .from('announcements')\n      .select('*')\n      .eq('is_active', true)\n      .lte('published_at', new Date().toISOString())\n      .or(`expires_at.is.null,expires_at.gte.${new Date().toISOString()}`)\n      .order('created_at', { ascending: false })\n      .limit(10)\n\n    const { data: announcements, error } = await query\n\n    if (error) {\n      console.error('Error fetching announcements:', error)\n      return NextResponse.json({\n        success: true,\n        announcements: [],\n        message: 'No announcements found',\n      })\n    }\n\n    // Filter announcements based on target audience\n    const filteredAnnouncements = announcements.filter((announcement) => {\n      const targetAudience = announcement.target_audience\n      if (!targetAudience || targetAudience === 'all') return true\n      if (targetAudience === 'students') return true\n      if (student && student.grade_level && targetAudience.includes(student.grade_level)) return true\n      return false\n    })\n\n    // Format the announcements data\n    const formattedAnnouncements = filteredAnnouncements.map((announcement) => ({\n      id: announcement.id,\n      title: announcement.title,\n      content: announcement.content,\n      date: announcement.created_at,\n      from: announcement.author_id, // You might want to join with users table to get author name\n      priority: announcement.priority || 'medium',\n    }))\n\n    return NextResponse.json({\n      success: true,\n      announcements: formattedAnnouncements,\n    })\n  } catch (error: any) {\n    console.error('Announcements API error:', error)\n    return NextResponse.json(\n      { success: false, error: error?.message || 'Internal server error' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,YAAY,aAAa,GAAG,CAAC;QAEnC,IAAI,CAAC,WAAW;YACd,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAyB,GAClD;gBAAE,QAAQ;YAAI;QAElB;QAEA,8CAA8C;QAC9C,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,mIAAQ,CAC1D,IAAI,CAAC,SACL,MAAM,CAAC,wBACP,EAAE,CAAC,MAAM,WACT,MAAM;QAET,IAAI,cAAc;YAChB,QAAQ,KAAK,CAAC,gCAAgC;QAChD;QAEA,6BAA6B;QAC7B,qEAAqE;QACrE,IAAI,QAAQ,mIAAQ,CACjB,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,aAAa,MAChB,GAAG,CAAC,gBAAgB,IAAI,OAAO,WAAW,IAC1C,EAAE,CAAC,CAAC,kCAAkC,EAAE,IAAI,OAAO,WAAW,IAAI,EAClE,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM,GACvC,KAAK,CAAC;QAET,MAAM,EAAE,MAAM,aAAa,EAAE,KAAK,EAAE,GAAG,MAAM;QAE7C,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,iCAAiC;YAC/C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,eAAe,EAAE;gBACjB,SAAS;YACX;QACF;QAEA,gDAAgD;QAChD,MAAM,wBAAwB,cAAc,MAAM,CAAC,CAAC;YAClD,MAAM,iBAAiB,aAAa,eAAe;YACnD,IAAI,CAAC,kBAAkB,mBAAmB,OAAO,OAAO;YACxD,IAAI,mBAAmB,YAAY,OAAO;YAC1C,IAAI,WAAW,QAAQ,WAAW,IAAI,eAAe,QAAQ,CAAC,QAAQ,WAAW,GAAG,OAAO;YAC3F,OAAO;QACT;QAEA,gCAAgC;QAChC,MAAM,yBAAyB,sBAAsB,GAAG,CAAC,CAAC,eAAiB,CAAC;gBAC1E,IAAI,aAAa,EAAE;gBACnB,OAAO,aAAa,KAAK;gBACzB,SAAS,aAAa,OAAO;gBAC7B,MAAM,aAAa,UAAU;gBAC7B,MAAM,aAAa,SAAS;gBAC5B,UAAU,aAAa,QAAQ,IAAI;YACrC,CAAC;QAED,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,eAAe;QACjB;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO,OAAO,WAAW;QAAwB,GACnE;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}