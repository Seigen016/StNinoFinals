{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///Users/koyaemer/Development/StNinoFinals/lib/supabaseClient.ts"],"sourcesContent":["// lib/supabaseClient.ts\nimport { Database } from '@/database.types'\nimport { createClient } from '@supabase/supabase-js'\n\n/**\n * Supabase Client for Client-Side Operations\n * \n * This client uses the ANON key and is safe to use in browser code.\n * It respects Row Level Security (RLS) policies in Supabase.\n * \n * DO NOT use service role key here - it bypasses RLS and is a security risk.\n * For admin operations, use getSupabaseAdmin() in server-side code only.\n */\n\n// Get environment variables\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n\n// Validate that environment variables are set\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error('Missing Supabase environment variables')\n}\n\n/**\n * Supabase client instance with typed database schema\n * Use this for all client-side database operations\n */\nexport const supabase = createClient<Database>(supabaseUrl, supabaseAnonKey)"],"names":[],"mappings":"AAAA,wBAAwB;;;;;AAExB;;AAEA;;;;;;;;CAQC,GAED,4BAA4B;AAC5B,MAAM;AACN,MAAM;AAEN,8CAA8C;AAC9C;;AAQO,MAAM,WAAW,IAAA,mRAAY,EAAW,aAAa"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///Users/koyaemer/Development/StNinoFinals/app/api/admin/stats/route.ts"],"sourcesContent":["import { supabase } from '@/lib/supabaseClient'\nimport { NextResponse } from 'next/server'\n\nexport async function GET() {\n  try {\n    // Fetch students count\n    const { count: studentsCount, error: studentsError } = await supabase\n      .from('users')\n      .eq('role', 'student')\n      .select('*', { count: 'exact', head: true })\n\n    // Fetch teachers count\n    const { count: teachersCount, error: teachersError } = await supabase\n      .from('users')\n      .eq('role', 'teacher')\n      .select('*', { count: 'exact', head: true })\n\n    if (studentsError || teachersError) {\n      console.error('Database error:', { studentsError, teachersError })\n      // Return mock data if database is not available\n      return NextResponse.json({\n        success: true,\n        data: {\n          totalStudents: 0,\n          totalTeachers: 0,\n          attendanceRate: 0,\n        },\n        mock: true,\n      })\n    }\n\n    // Calculate attendance (this would need actual attendance data)\n    // For now, we'll return 0 and calculate it later when we have attendance table\n    const attendanceRate = 0\n\n    return NextResponse.json({\n      success: true,\n      data: {\n        totalStudents: studentsCount || 0,\n        totalTeachers: teachersCount || 0,\n        attendanceRate,\n      },\n    })\n  } catch (error: any) {\n    console.error('Admin stats API error:', error)\n    // Return 200 with error message instead of 500 to prevent Internal Server Error page\n    return NextResponse.json(\n      {\n        success: true, // Return success with mock data to prevent frontend crash\n        error: error?.message || 'Database connection error',\n        data: {\n          totalStudents: 0,\n          totalTeachers: 0,\n          attendanceRate: 0,\n        },\n        mock: true,\n      },\n      { status: 200 } // Always return 200, never 500\n    )\n  }\n}\n\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IACpB,IAAI;QACF,uBAAuB;QACvB,MAAM,EAAE,OAAO,aAAa,EAAE,OAAO,aAAa,EAAE,GAAG,MAAM,mIAAQ,CAClE,IAAI,CAAC,SACL,EAAE,CAAC,QAAQ,WACX,MAAM,CAAC,KAAK;YAAE,OAAO;YAAS,MAAM;QAAK;QAE5C,uBAAuB;QACvB,MAAM,EAAE,OAAO,aAAa,EAAE,OAAO,aAAa,EAAE,GAAG,MAAM,mIAAQ,CAClE,IAAI,CAAC,SACL,EAAE,CAAC,QAAQ,WACX,MAAM,CAAC,KAAK;YAAE,OAAO;YAAS,MAAM;QAAK;QAE5C,IAAI,iBAAiB,eAAe;YAClC,QAAQ,KAAK,CAAC,mBAAmB;gBAAE;gBAAe;YAAc;YAChE,gDAAgD;YAChD,OAAO,+QAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,MAAM;oBACJ,eAAe;oBACf,eAAe;oBACf,gBAAgB;gBAClB;gBACA,MAAM;YACR;QACF;QAEA,gEAAgE;QAChE,+EAA+E;QAC/E,MAAM,iBAAiB;QAEvB,OAAO,+QAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;gBACJ,eAAe,iBAAiB;gBAChC,eAAe,iBAAiB;gBAChC;YACF;QACF;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,0BAA0B;QACxC,qFAAqF;QACrF,OAAO,+QAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,OAAO,OAAO,WAAW;YACzB,MAAM;gBACJ,eAAe;gBACf,eAAe;gBACf,gBAAgB;YAClB;YACA,MAAM;QACR,GACA;YAAE,QAAQ;QAAI,EAAE,+BAA+B;;IAEnD;AACF"}}]
}