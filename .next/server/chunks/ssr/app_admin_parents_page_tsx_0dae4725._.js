module.exports=[62092,a=>{"use strict";var b=a.i(95526),c=a.i(54161),d=a.i(40695),e=a.i(3130),f=a.i(65733),g=a.i(5522),h=a.i(17171),i=a.i(87682),j=a.i(53071),k=a.i(88237),l=a.i(35393),m=a.i(82804),n=a.i(62159),o=a.i(63192),p=a.i(77889),q=a.i(5378),r=a.i(21753),s=a.i(75023),t=a.i(86569),u=a.i(4640),v=a.i(21113),w=a.i(19770),x=a.i(30924);function y(){let{admin:a,loading:y}=(0,x.useAuth)(),[z,A]=(0,v.useState)([]),[B,C]=(0,v.useState)([]),[D,E]=(0,v.useState)(!1),[F,G]=(0,v.useState)(""),[H,I]=(0,v.useState)(!1),[J,K]=(0,v.useState)(!1),[L,M]=(0,v.useState)(!1),[N,O]=(0,v.useState)(!1),[P,Q]=(0,v.useState)(null),{showAlert:R}=(0,l.useAlert)(),{showConfirm:S}=(0,m.useConfirm)(),[T,U]=(0,v.useState)({first_name:"",last_name:"",middle_name:"",email:"",phone_number:"",address:""}),[V,W]=(0,v.useState)({id:"",first_name:"",last_name:"",middle_name:"",email:"",phone_number:"",address:""}),[X,Y]=(0,v.useState)({parent_id:"",student_id:"",relationship_type:"parent",is_primary:!0}),[Z,$]=(0,v.useState)(!1),[_,aa]=(0,v.useState)(!1),[ab,ac]=(0,v.useState)(!1),[ad,ae]=(0,v.useState)(!1),[af,ag]=(0,v.useState)(""),[ah,ai]=(0,v.useState)(""),[aj,ak]=(0,v.useState)(""),al=async()=>{E(!0);try{let a=await fetch("/api/admin/parents"),b=await a.json();b.success&&b.parents&&A(b.parents)}catch(a){console.error("Error fetching parents:",a)}finally{E(!1)}},am=async()=>{try{let a=await fetch("/api/admin/students"),b=await a.json();b.success&&b.students&&C(b.students)}catch(a){console.error("Error fetching students:",a)}};(0,v.useEffect)(()=>{al(),am()},[]);let an=z.filter(a=>`${a.first_name} ${a.last_name} ${a.email}`.toLowerCase().includes(F.toLowerCase())),ao=async a=>{a.preventDefault(),$(!0),ag("");try{let a=`Parent${Math.random().toString(36).slice(-8)}${Math.floor(100*Math.random())}`,b=await fetch("/api/admin/parents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...T,password:a})}),c=await b.json();if(!c.success)throw Error(c.error||"Failed to add parent");await al(),U({first_name:"",last_name:"",middle_name:"",email:"",phone_number:"",address:""}),I(!1),R({message:`Parent added successfully!

Login Credentials:
Email: ${T.email}
Password: ${a}

Please save these credentials!`,type:"success"})}catch(a){ag(a?.message||"Failed to add parent.")}finally{$(!1)}},ap=async a=>{a.preventDefault(),aa(!0),ai("");try{let a=await fetch(`/api/admin/parents/${V.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)}),b=await a.json();if(!b.success)throw Error(b.error||"Failed to update parent");await al(),K(!1),R({message:"Parent updated successfully!",type:"success"})}catch(a){ai(a?.message||"Failed to update parent.")}finally{aa(!1)}},aq=async(a,b)=>{if(await S({message:`Are you sure you want to delete ${b}? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",variant:"destructive"})){ac(!0);try{let b=await fetch(`/api/admin/parents/${a}`,{method:"DELETE"}),c=await b.json();if(!c.success)throw Error(c.error||"Failed to delete parent");await al(),R({message:"Parent deleted successfully!",type:"success"})}catch(a){R({message:a?.message||"Failed to delete parent.",type:"error"})}finally{ac(!1)}}},ar=async a=>{a.preventDefault(),ae(!0),ak("");try{let a=await fetch("/api/admin/parents/link-student",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)}),b=await a.json();if(!b.success)throw Error(b.error||"Failed to link student");await al(),O(!1),Y({parent_id:"",student_id:"",relationship_type:"parent",is_primary:!0}),R({message:"Student linked successfully!",type:"success"})}catch(a){ak(a?.message||"Failed to link student.")}finally{ae(!1)}};return y||!a?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-red-50",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-red-800 border-t-transparent"}),(0,b.jsx)("p",{className:"mt-4 text-red-800 font-medium",children:"Loading..."})]})}):(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-red-50",children:[(0,b.jsx)(w.AdminHeader,{admin:a}),(0,b.jsxs)("div",{className:"container mx-auto px-6 py-8",children:[(0,b.jsxs)("div",{className:"mb-6 flex items-center gap-4",children:[(0,b.jsx)(u.default,{href:"/admin",children:(0,b.jsxs)(d.Button,{variant:"ghost",size:"sm",className:"hover:bg-red-50",children:[(0,b.jsx)(n.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h2",{className:"text-3xl font-bold text-red-800",children:"Parent/Guardian Management"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage parent and guardian accounts"})]}),(0,b.jsxs)(f.Dialog,{open:H,onOpenChange:I,children:[(0,b.jsx)(f.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(d.Button,{className:"bg-red-800 hover:bg-red-700",children:[(0,b.jsx)(s.UserPlus,{className:"w-4 h-4 mr-2"}),"Add Parent"]})}),(0,b.jsxs)(f.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{className:"text-red-800",children:"Add New Parent/Guardian"}),(0,b.jsx)(f.DialogDescription,{children:"Enter parent information to create a new account"})]}),(0,b.jsxs)("form",{onSubmit:ao,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"First Name *"}),(0,b.jsx)(g.Input,{value:T.first_name,onChange:a=>U({...T,first_name:a.target.value}),placeholder:"Enter first name",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"Last Name *"}),(0,b.jsx)(g.Input,{value:T.last_name,onChange:a=>U({...T,last_name:a.target.value}),placeholder:"Enter last name",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"Middle Name"}),(0,b.jsx)(g.Input,{value:T.middle_name,onChange:a=>U({...T,middle_name:a.target.value}),placeholder:"Enter middle name"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"Email *"}),(0,b.jsx)(g.Input,{type:"email",value:T.email,onChange:a=>U({...T,email:a.target.value}),placeholder:"Enter email address",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"Phone Number *"}),(0,b.jsx)(g.Input,{value:T.phone_number,onChange:a=>U({...T,phone_number:a.target.value}),placeholder:"Enter phone number",required:!0})]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)(h.Label,{children:"Address"}),(0,b.jsx)(g.Input,{value:T.address,onChange:a=>U({...T,address:a.target.value}),placeholder:"Enter complete address"})]})]}),af&&(0,b.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded",children:af}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>I(!1),disabled:Z,children:"Cancel"}),(0,b.jsx)(d.Button,{type:"submit",className:"bg-red-800 hover:bg-red-700",disabled:Z,children:Z?"Adding...":"Add Parent"})]})]})]})]})]}),(0,b.jsx)(f.Dialog,{open:J,onOpenChange:K,children:(0,b.jsxs)(f.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{className:"text-red-800",children:"Edit Parent/Guardian"}),(0,b.jsx)(f.DialogDescription,{children:"Update parent information"})]}),(0,b.jsxs)("form",{onSubmit:ap,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"First Name *"}),(0,b.jsx)(g.Input,{value:V.first_name,onChange:a=>W({...V,first_name:a.target.value}),placeholder:"Enter first name",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"Last Name *"}),(0,b.jsx)(g.Input,{value:V.last_name,onChange:a=>W({...V,last_name:a.target.value}),placeholder:"Enter last name",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"Middle Name"}),(0,b.jsx)(g.Input,{value:V.middle_name,onChange:a=>W({...V,middle_name:a.target.value}),placeholder:"Enter middle name"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"Email *"}),(0,b.jsx)(g.Input,{type:"email",value:V.email,onChange:a=>W({...V,email:a.target.value}),placeholder:"Enter email address",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"Phone Number"}),(0,b.jsx)(g.Input,{value:V.phone_number,onChange:a=>W({...V,phone_number:a.target.value}),placeholder:"Enter phone number"})]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)(h.Label,{children:"Address"}),(0,b.jsx)(g.Input,{value:V.address,onChange:a=>W({...V,address:a.target.value}),placeholder:"Enter complete address"})]})]}),ah&&(0,b.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded",children:ah}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>K(!1),disabled:_,children:"Cancel"}),(0,b.jsx)(d.Button,{type:"submit",className:"bg-red-800 hover:bg-red-700",disabled:_,children:_?"Updating...":"Update Parent"})]})]})]})}),(0,b.jsx)(j.Sheet,{open:L,onOpenChange:M,children:(0,b.jsxs)(j.SheetContent,{side:"right",className:"w-full sm:max-w-lg overflow-y-auto",children:[(0,b.jsxs)(j.SheetHeader,{children:[(0,b.jsx)(j.SheetTitle,{className:"text-red-800",children:"Parent/Guardian Details"}),(0,b.jsx)(j.SheetDescription,{children:"View complete parent/guardian information"})]}),P&&(0,b.jsxs)("div",{className:"space-y-6 mt-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"pb-3 border-b",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Full Name"}),(0,b.jsx)("p",{className:"text-base font-semibold",children:`${P.first_name} ${P.middle_name||""} ${P.last_name}`.trim()})]}),(0,b.jsxs)("div",{className:"pb-3 border-b",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Email"}),(0,b.jsx)("p",{className:"text-base",children:P.email})]}),(0,b.jsxs)("div",{className:"pb-3 border-b",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Phone Number"}),(0,b.jsx)("p",{className:"text-base",children:P.phone_number||"N/A"})]}),(0,b.jsxs)("div",{className:"pb-3 border-b",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Address"}),(0,b.jsx)("p",{className:"text-base",children:P.address||"N/A"})]}),(0,b.jsxs)("div",{className:"pb-3 border-b",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Status"}),(0,b.jsx)(c.Badge,{className:"bg-green-100 text-green-800",children:P.status})]})]}),P.children&&P.children.length>0&&(0,b.jsxs)("div",{className:"pt-2",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-3",children:"Children/Wards"}),(0,b.jsx)("div",{className:"space-y-2",children:P.children.map(a=>(0,b.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg flex items-center justify-between hover:bg-gray-100 transition-colors",children:[(0,b.jsx)("span",{className:"font-medium",children:a.name}),(0,b.jsx)(c.Badge,{variant:"outline",className:"bg-white",children:a.relationship_type})]},a.id))})]})]})]})}),(0,b.jsx)(f.Dialog,{open:N,onOpenChange:O,children:(0,b.jsxs)(f.DialogContent,{children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{className:"text-red-800",children:"Link Student to Parent"}),(0,b.jsx)(f.DialogDescription,{children:"Associate a student with this parent/guardian"})]}),(0,b.jsxs)("form",{onSubmit:ar,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"Select Student *"}),(0,b.jsxs)(i.Select,{value:X.student_id,onValueChange:a=>Y({...X,student_id:a}),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"Choose a student"})}),(0,b.jsx)(i.SelectContent,{children:B.map(a=>(0,b.jsxs)(i.SelectItem,{value:a.id,children:[a.first_name," ",a.last_name," - ",a.student_number]},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"Relationship *"}),(0,b.jsxs)(i.Select,{value:X.relationship_type,onValueChange:a=>Y({...X,relationship_type:a}),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"parent",children:"Parent"}),(0,b.jsx)(i.SelectItem,{value:"father",children:"Father"}),(0,b.jsx)(i.SelectItem,{value:"mother",children:"Mother"}),(0,b.jsx)(i.SelectItem,{value:"guardian",children:"Guardian"}),(0,b.jsx)(i.SelectItem,{value:"grandparent",children:"Grandparent"}),(0,b.jsx)(i.SelectItem,{value:"aunt",children:"Aunt"}),(0,b.jsx)(i.SelectItem,{value:"uncle",children:"Uncle"}),(0,b.jsx)(i.SelectItem,{value:"sibling",children:"Sibling"}),(0,b.jsx)(i.SelectItem,{value:"other",children:"Other"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"is_primary",checked:X.is_primary,onChange:a=>Y({...X,is_primary:a.target.checked}),className:"rounded"}),(0,b.jsx)(h.Label,{htmlFor:"is_primary",children:"Primary Contact"})]}),aj&&(0,b.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded",children:aj}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>O(!1),disabled:ad,children:"Cancel"}),(0,b.jsx)(d.Button,{type:"submit",className:"bg-red-800 hover:bg-red-700",disabled:ad,children:ad?"Linking...":"Link Student"})]})]})]})}),(0,b.jsxs)(e.Card,{className:"shadow-md",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(e.CardTitle,{className:"text-red-800",children:["All Parents (",an.length,")"]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(q.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,b.jsx)(g.Input,{placeholder:"Search parents...",className:"pl-10 w-64",value:F,onChange:a=>G(a.target.value)})]})})]})}),(0,b.jsx)(e.CardContent,{children:D?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-800 mx-auto"}),(0,b.jsx)("p",{className:"text-gray-600 mt-2",children:"Loading parents..."})]}):(0,b.jsxs)(k.Table,{children:[(0,b.jsx)(k.TableHeader,{children:(0,b.jsxs)(k.TableRow,{children:[(0,b.jsx)(k.TableHead,{children:"Name"}),(0,b.jsx)(k.TableHead,{children:"Email"}),(0,b.jsx)(k.TableHead,{children:"Phone"}),(0,b.jsx)(k.TableHead,{children:"Children"}),(0,b.jsx)(k.TableHead,{children:"Status"}),(0,b.jsx)(k.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(k.TableBody,{children:an.length>0?an.map(a=>(0,b.jsxs)(k.TableRow,{children:[(0,b.jsx)(k.TableCell,{className:"font-medium",children:`${a.first_name} ${a.last_name}`}),(0,b.jsx)(k.TableCell,{children:a.email}),(0,b.jsx)(k.TableCell,{children:a.phone_number||"N/A"}),(0,b.jsx)(k.TableCell,{children:a.children&&a.children.length>0?(0,b.jsxs)(c.Badge,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[a.children.length," ",1===a.children.length?"child":"children"]}):(0,b.jsx)("span",{className:"text-gray-400 text-sm",children:"No children linked"})}),(0,b.jsx)(k.TableCell,{children:(0,b.jsx)(c.Badge,{className:"bg-green-100 text-green-800",children:a.status||"Active"})}),(0,b.jsx)(k.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>{Q(a),M(!0)},children:(0,b.jsx)(p.Eye,{className:"w-4 h-4"})}),(0,b.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>{Y({parent_id:a.id,student_id:"",relationship_type:"parent",is_primary:!0}),O(!0)},children:(0,b.jsx)(t.Users,{className:"w-4 h-4"})}),(0,b.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>{W({id:a.id,first_name:a.first_name,last_name:a.last_name,middle_name:a.middle_name||"",email:a.email,phone_number:a.phone_number||"",address:a.address||""}),K(!0)},children:(0,b.jsx)(o.Edit,{className:"w-4 h-4"})}),(0,b.jsx)(d.Button,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>aq(a.id,`${a.first_name} ${a.last_name}`),disabled:ab,children:(0,b.jsx)(r.Trash2,{className:"w-4 h-4"})})]})})]},a.id)):(0,b.jsx)(k.TableRow,{children:(0,b.jsx)(k.TableCell,{colSpan:6,className:"text-center text-gray-500 py-8",children:"No parents found"})})})]})})]})]})]})}a.s(["default",()=>y])}];

//# sourceMappingURL=app_admin_parents_page_tsx_0dae4725._.js.map