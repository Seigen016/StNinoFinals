module.exports=[32666,a=>{"use strict";var b=a.i(95526),c=a.i(21113),d=a.i(4640),e=a.i(40695),f=a.i(3130),g=a.i(5522),h=a.i(17171),i=a.i(88237),j=a.i(54161),k=a.i(87682),l=a.i(62159),m=a.i(88533),n=a.i(46916);function o(){let[a,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(!0),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)("");(0,c.useEffect)(()=>{let a=new Date,b=new Date;b.setDate(b.getDate()-30),u(b.toISOString().split("T")[0]),w(a.toISOString().split("T")[0])},[]);let x=async()=>{q(!0);try{let a=new URLSearchParams;t&&a.append("startDate",t),v&&a.append("endDate",v),r&&a.append("teacherId",r);let b=await fetch(`/api/admin/teacher-attendance?${a.toString()}`),c=await b.json();c.success&&c.data&&(o(c.data),!r&&c.data.teachers.length>0&&s(c.data.teachers[0].teacherId))}catch(a){console.error("Error fetching teacher attendance:",a)}finally{q(!1)}};(0,c.useEffect)(()=>{t&&v&&x()},[t,v,r]);let y=(0,c.useMemo)(()=>a&&r?a.teachers.find(a=>a.teacherId===r)||a.selectedTeacher:null,[a,r]),z=(0,c.useMemo)(()=>{if(!a)return[];let b=[],c=new Date(a.dateRange.start),d=new Date(a.dateRange.end);for(let a=new Date(c);a<=d;a.setDate(a.getDate()+1))b.push(new Date(a).toISOString().split("T")[0]);return b},[a]),A=a=>new Date(a).toLocaleDateString("en-US",{weekday:"short",month:"numeric",day:"numeric"});return p?(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(m.RefreshCcw,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-red-800"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading teacher attendance data..."})]})}):(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("header",{className:"bg-white shadow-md border-b-4 border-red-800",children:(0,b.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)(d.default,{href:"/admin",children:(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(l.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-red-800",children:"Teacher Attendance Analytics"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Track and analyze teacher attendance records"})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 flex-wrap",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(h.Label,{htmlFor:"startDate",className:"text-sm",children:"Start Date:"}),(0,b.jsx)(g.Input,{id:"startDate",type:"date",value:t,onChange:a=>u(a.target.value),className:"w-40"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(h.Label,{htmlFor:"endDate",className:"text-sm",children:"End Date:"}),(0,b.jsx)(g.Input,{id:"endDate",type:"date",value:v,onChange:a=>w(a.target.value),className:"w-40"})]}),(0,b.jsxs)(e.Button,{onClick:x,variant:"outline",size:"sm",children:[(0,b.jsx)(m.RefreshCcw,{className:"w-4 h-4 mr-2"}),"Refresh"]}),a&&a.teachers.length>0&&(0,b.jsxs)(e.Button,{onClick:()=>{if(!a||!a.teachers.length)return;let b=[];if(a.dateRange.start&&a.dateRange.end){let c=new Date(a.dateRange.start),d=new Date(a.dateRange.end);for(let a=new Date(c);a<=d;a.setDate(a.getDate()+1))b.push(new Date(a).toISOString().split("T")[0])}let c=[["#","Name","Subject","Total Days","Present","Absent","Late","%",...b.map(a=>A(a))]];a.teachers.forEach((a,d)=>{let e=[(d+1).toString(),a.teacherName,a.subject||"N/A",a.totalDays.toString(),a.present.toString(),a.absent.toString(),a.late.toString(),`${a.percentage}%`,...b.map(b=>a.dailyAttendance[b]||"-")];c.push(e)});let d=new Blob([c.map(a=>a.map(a=>`"${a.toString().replace(/"/g,'""')}"`).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),e=document.createElement("a"),f=URL.createObjectURL(d);e.setAttribute("href",f),e.setAttribute("download",`teacher-attendance-report-${t}-to-${v}.csv`),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e)},variant:"outline",size:"sm",className:"bg-green-50 hover:bg-green-100",children:[(0,b.jsx)(n.Download,{className:"w-4 h-4 mr-2"}),"Export CSV"]})]})]})})}),(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:a&&0!==a.teachers.length?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[(0,b.jsxs)(f.Card,{className:"lg:col-span-2",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-red-800",children:"GENERAL ATTENDANCE"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"flex items-center justify-center space-x-8",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:"text-3xl font-bold text-red-600",children:[a.general.absentPercentage.toFixed(1),"%"]}),(0,b.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"Absent"})]}),(0,b.jsxs)("div",{className:"relative w-32 h-32",children:[(0,b.jsxs)("svg",{className:"transform -rotate-90 w-32 h-32",children:[(0,b.jsx)("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"8",fill:"transparent",className:"text-gray-200"}),(0,b.jsx)("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"8",fill:"transparent",strokeDasharray:`${2*Math.PI*56}`,strokeDashoffset:`${2*Math.PI*56*(1-a.general.presentPercentage/100)}`,className:"text-green-500",strokeLinecap:"round"})]}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[a.general.presentPercentage.toFixed(1),"%"]}),(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Present"})]})})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:"text-3xl font-bold text-green-600",children:[a.general.presentPercentage.toFixed(1),"%"]}),(0,b.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"Present"})]})]})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-red-800",children:"SELECTED TEACHER"})}),(0,b.jsxs)(f.CardContent,{children:[(0,b.jsxs)(k.Select,{value:r,onValueChange:s,children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select Teacher"})}),(0,b.jsx)(k.SelectContent,{children:a.teachers.map(a=>(0,b.jsx)(k.SelectItem,{value:a.teacherId,children:a.teacherName},a.teacherId))})]}),y&&(0,b.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Total Days:"}),(0,b.jsx)("span",{className:"font-semibold",children:y.totalDays})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Present:"}),(0,b.jsx)("span",{className:"font-semibold text-green-600",children:y.present})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Absent:"}),(0,b.jsx)("span",{className:"font-semibold text-red-600",children:y.absent})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Late:"}),(0,b.jsx)("span",{className:"font-semibold text-yellow-600",children:y.late})]}),(0,b.jsx)("div",{className:"mt-4 p-3 bg-orange-100 rounded-lg",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:"text-3xl font-bold text-orange-600",children:[y.percentage,"%"]}),(0,b.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"Attendance Rate"})]})})]})]})]})]}),y&&(0,b.jsxs)(f.Card,{className:"mb-6",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"text-red-800",children:[y.teacherName," - Attendance Breakdown"]}),(0,b.jsxs)(f.CardDescription,{children:["Subject: ",y.subject]})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[(0,b.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:y.present}),(0,b.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"PR (Present)"})]}),(0,b.jsxs)("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-red-600",children:y.absent}),(0,b.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"AC (Absent)"})]}),(0,b.jsxs)("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:y.late}),(0,b.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"LA (Late)"})]}),(0,b.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-gray-600",children:"0"}),(0,b.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"HO (Holiday)"})]}),(0,b.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-gray-600",children:"0"}),(0,b.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"VA (Vacation)"})]}),(0,b.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-gray-600",children:"0"}),(0,b.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"CR (Credit)"})]})]})})]}),(0,b.jsxs)(f.Card,{className:"mb-6",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-red-800",children:"ATTENDANCE PERCENTAGE BY TEACHER"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:a.teachers.slice(0,10).map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("div",{className:"w-32 text-sm text-gray-700 truncate",children:a.teacherName}),(0,b.jsxs)("div",{className:"flex-1 h-8 bg-gray-200 rounded-full overflow-hidden relative",children:[(0,b.jsx)("div",{className:`h-full ${a.percentage>=90?"bg-green-500":a.percentage>=70?"bg-yellow-500":"bg-red-500"} transition-all duration-500`,style:{width:`${a.percentage}%`}}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsxs)("span",{className:"text-xs font-semibold text-gray-900",children:[a.percentage,"%"]})})]})]},a.teacherId))})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{className:"text-red-800",children:"DAILY ATTENDANCE RECORDS"}),(0,b.jsxs)(f.CardDescription,{children:["Showing attendance for ",a.teachers.length," teacher",1!==a.teachers.length?"s":""]})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{className:"w-12",children:"#"}),(0,b.jsx)(i.TableHead,{children:"Name"}),(0,b.jsx)(i.TableHead,{className:"text-center",children:"Total Days"}),(0,b.jsx)(i.TableHead,{className:"text-center",children:"Present"}),(0,b.jsx)(i.TableHead,{className:"text-center",children:"%"}),z.slice(0,20).map(a=>(0,b.jsx)(i.TableHead,{className:"text-center min-w-[80px]",children:A(a)},a))]})}),(0,b.jsx)(i.TableBody,{children:a.teachers.map((a,c)=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{className:"font-medium",children:c+1}),(0,b.jsx)(i.TableCell,{className:"font-semibold",children:a.teacherName}),(0,b.jsx)(i.TableCell,{className:"text-center",children:a.totalDays}),(0,b.jsx)(i.TableCell,{className:"text-center",children:a.present}),(0,b.jsx)(i.TableCell,{className:"text-center",children:(0,b.jsxs)(j.Badge,{className:a.percentage>=90?"bg-green-500":a.percentage>=70?"bg-yellow-500":"bg-red-500",children:[a.percentage,"%"]})}),z.slice(0,20).map(c=>{let d=a.dailyAttendance[c]||"-";return(0,b.jsx)(i.TableCell,{className:"text-center",children:"-"!==d?(0,b.jsx)(j.Badge,{className:`${(a=>{switch(a){case"PR":return"bg-green-500 text-white";case"AC":return"bg-red-500 text-white";case"LA":return"bg-yellow-500 text-white";case"HO":return"bg-gray-400 text-white";case"VA":return"bg-blue-400 text-white";case"CR":return"bg-purple-400 text-white";default:return"bg-gray-300 text-gray-700"}})(d)} text-xs px-1 py-0`,title:{PR:"Present",AC:"Absent - Coded",LA:"Late",HO:"Holiday",VA:"Vacation",CR:"Credit",EA:"Early Absent",DA:"Day Absent",SU:"Suspended",O:"Other",D1:"Day 1",D2:"Day 2",D3:"Day 3",D4:"Day 4",D5:"Day 5",D6:"Day 6"}[d]||d,children:d}):(0,b.jsx)("span",{className:"text-gray-400",children:"-"})},c)})]},a.teacherId))})]})})})]})]}):(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)("p",{className:"text-gray-600",children:"No teacher attendance data available."}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Teachers will appear here once they start scanning their RFID cards."})]})})})]})}a.s(["default",()=>o])}];

//# sourceMappingURL=app_admin_teacher-attendance_page_tsx_48c96c10._.js.map